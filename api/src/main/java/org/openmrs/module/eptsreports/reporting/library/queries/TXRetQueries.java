package org.openmrs.module.eptsreports.reporting.library.queries;

public class TXRetQueries {
  private static final String obito =
      "SELECT inicio.patient_id\n"
          + "FROM\n"
          + "  (SELECT patient_id,\n"
          + "          DATA\n"
          + "   FROM\n"
          + "     (SELECT patient_id,\n"
          + "             min(DATA) DATA\n"
          + "      FROM\n"
          + "        (SELECT p.patient_id,\n"
          + "                min(e.encounter_datetime) DATA\n"
          + "         FROM patient p\n"
          + "         INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "         INNER JOIN obs o ON o.encounter_id=e.encounter_id\n"
          + "         WHERE e.voided=0\n"
          + "           AND o.voided=0\n"
          + "           AND p.voided=0\n"
          + "           AND e.encounter_type IN (18,\n"
          + "                                    6,\n"
          + "                                    9)\n"
          + "           AND o.concept_id=1255\n"
          + "           AND o.value_coded=1256\n"
          + "           AND e.encounter_datetime<=CASE\n"
          + "                                         WHEN :months=12 THEN :endDate\n"
          + "                                         WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                         ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                     END\n"
          + "           AND e.location_id=:location\n"
          + "         GROUP BY p.patient_id\n"
          + "         UNION SELECT p.patient_id,\n"
          + "                      min(value_datetime) DATA\n"
          + "         FROM patient p\n"
          + "         INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "         INNER JOIN obs o ON e.encounter_id=o.encounter_id\n"
          + "         WHERE p.voided=0\n"
          + "           AND e.voided=0\n"
          + "           AND o.voided=0\n"
          + "           AND e.encounter_type IN (18,\n"
          + "                                    6,\n"
          + "                                    9)\n"
          + "           AND o.concept_id=1190\n"
          + "           AND o.value_datetime IS NOT NULL\n"
          + "           AND o.value_datetime<=CASE\n"
          + "                                     WHEN :months=12 THEN :endDate\n"
          + "                                     WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                     ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                 END\n"
          + "           AND e.location_id=:location\n"
          + "         GROUP BY p.patient_id\n"
          + "         UNION SELECT pg.patient_id,\n"
          + "                      date_enrolled DATA\n"
          + "         FROM patient p\n"
          + "         INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "         WHERE pg.voided=0\n"
          + "           AND p.voided=0\n"
          + "           AND program_id=2\n"
          + "           AND date_enrolled<=CASE\n"
          + "                                  WHEN :months=12 THEN :endDate\n"
          + "                                  WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                  ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                              END\n"
          + "           AND location_id=:location\n"
          + "         UNION SELECT e.patient_id,\n"
          + "                      MIN(e.encounter_datetime) AS DATA\n"
          + "         FROM patient p\n"
          + "         INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "         WHERE p.voided=0\n"
          + "           AND e.encounter_type=18\n"
          + "           AND e.voided=0\n"
          + "           AND e.encounter_datetime<=CASE\n"
          + "                                         WHEN :months=12 THEN :endDate\n"
          + "                                         WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                         ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                     END\n"
          + "           AND e.location_id=:location\n"
          + "         GROUP BY p.patient_id) inicio\n"
          + "      GROUP BY patient_id)inicio1\n"
          + "   WHERE DATA BETWEEN CASE\n"
          + "                          WHEN :months=12 THEN :startDate\n"
          + "                          WHEN :months=24 THEN date_add(:endDate, interval -15 MONTH)\n"
          + "                          ELSE date_add(:endDate, interval -27 MONTH)\n"
          + "                      END AND CASE\n"
          + "                                  WHEN :months=12 THEN :endDate\n"
          + "                                  WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                  ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                              END ) inicio\n"
          + "WHERE inicio.patient_id NOT IN\n"
          + "    (SELECT pg.patient_id\n"
          + "     FROM patient p\n"
          + "     INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "     INNER JOIN patient_state ps ON pg.patient_program_id=ps.patient_program_id\n"
          + "     WHERE pg.voided=0\n"
          + "       AND ps.voided=0\n"
          + "       AND p.voided=0\n"
          + "       AND pg.program_id=2\n"
          + "       AND ps.state=7\n"
          + "       AND ps.end_date IS NULL\n"
          + "       AND pg.location_id=:location\n"
          + "       AND ps.start_date BETWEEN\n"
          + "         (SELECT inicio.data\n"
          + "          FROM dual\n"
          + "          WHERE p.patient_id=inicio.patient_id) AND date_add(\n"
          + "                                                               (SELECT inicio.data\n"
          + "                                                                FROM dual\n"
          + "                                                                WHERE p.patient_id=inicio.patient_id), interval :months MONTH) )\n"
          + "  AND inicio.patient_id IN\n"
          + "    (SELECT pg.patient_id\n"
          + "     FROM patient p\n"
          + "     INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "     INNER JOIN patient_state ps ON pg.patient_program_id=ps.patient_program_id\n"
          + "     WHERE pg.voided=0\n"
          + "       AND ps.voided=0\n"
          + "       AND p.voided=0\n"
          + "       AND pg.program_id=2\n"
          + "       AND ps.state = 10\n"
          + "       AND ps.end_date IS NULL\n"
          + "       AND ps.start_date BETWEEN\n"
          + "         (SELECT inicio.data\n"
          + "          FROM dual\n"
          + "          WHERE pg.patient_id=inicio.patient_id) AND date_add(\n"
          + "                                                                (SELECT inicio.data\n"
          + "                                                                 FROM dual\n"
          + "                                                                 WHERE pg.patient_id=inicio.patient_id), interval :months MONTH)\n"
          + "       AND location_id=:location )";

  private static final String suspenso =
      "SELECT inicio.patient_id\n"
          + "FROM\n"
          + "  (SELECT patient_id,\n"
          + "          DATA\n"
          + "   FROM\n"
          + "     (SELECT patient_id,\n"
          + "             min(DATA) DATA\n"
          + "      FROM\n"
          + "        (SELECT p.patient_id,\n"
          + "                min(e.encounter_datetime) DATA\n"
          + "         FROM patient p\n"
          + "         INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "         INNER JOIN obs o ON o.encounter_id=e.encounter_id\n"
          + "         WHERE e.voided=0\n"
          + "           AND o.voided=0\n"
          + "           AND p.voided=0\n"
          + "           AND e.encounter_type IN (18,\n"
          + "                                    6,\n"
          + "                                    9)\n"
          + "           AND o.concept_id=1255\n"
          + "           AND o.value_coded=1256\n"
          + "           AND e.encounter_datetime<=CASE\n"
          + "                                         WHEN :months=12 THEN :endDate\n"
          + "                                         WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                         ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                     END\n"
          + "           AND e.location_id=:location\n"
          + "         GROUP BY p.patient_id\n"
          + "         UNION SELECT p.patient_id,\n"
          + "                      min(value_datetime) DATA\n"
          + "         FROM patient p\n"
          + "         INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "         INNER JOIN obs o ON e.encounter_id=o.encounter_id\n"
          + "         WHERE p.voided=0\n"
          + "           AND e.voided=0\n"
          + "           AND o.voided=0\n"
          + "           AND e.encounter_type IN (18,\n"
          + "                                    6,\n"
          + "                                    9)\n"
          + "           AND o.concept_id=1190\n"
          + "           AND o.value_datetime IS NOT NULL\n"
          + "           AND o.value_datetime<=CASE\n"
          + "                                     WHEN :months=12 THEN :endDate\n"
          + "                                     WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                     ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                 END\n"
          + "           AND e.location_id=:location\n"
          + "         GROUP BY p.patient_id\n"
          + "         UNION SELECT pg.patient_id,\n"
          + "                      date_enrolled DATA\n"
          + "         FROM patient p\n"
          + "         INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "         WHERE pg.voided=0\n"
          + "           AND p.voided=0\n"
          + "           AND program_id=2\n"
          + "           AND date_enrolled<=CASE\n"
          + "                                  WHEN :months=12 THEN :endDate\n"
          + "                                  WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                  ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                              END\n"
          + "           AND location_id=:location\n"
          + "         UNION SELECT e.patient_id,\n"
          + "                      MIN(e.encounter_datetime) AS DATA\n"
          + "         FROM patient p\n"
          + "         INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "         WHERE p.voided=0\n"
          + "           AND e.encounter_type=18\n"
          + "           AND e.voided=0\n"
          + "           AND e.encounter_datetime<=CASE\n"
          + "                                         WHEN :months=12 THEN :endDate\n"
          + "                                         WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                         ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                     END\n"
          + "           AND e.location_id=:location\n"
          + "         GROUP BY p.patient_id) inicio\n"
          + "      GROUP BY patient_id)inicio1\n"
          + "   WHERE DATA BETWEEN CASE\n"
          + "                          WHEN :months=12 THEN :startDate\n"
          + "                          WHEN :months=24 THEN date_add(:endDate, interval -15 MONTH)\n"
          + "                          ELSE date_add(:endDate, interval -27 MONTH)\n"
          + "                      END AND CASE\n"
          + "                                  WHEN :months=12 THEN :endDate\n"
          + "                                  WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                  ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                              END ) inicio\n"
          + "WHERE inicio.patient_id NOT IN\n"
          + "    (SELECT pg.patient_id\n"
          + "     FROM patient p\n"
          + "     INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "     INNER JOIN patient_state ps ON pg.patient_program_id=ps.patient_program_id\n"
          + "     WHERE pg.voided=0\n"
          + "       AND ps.voided=0\n"
          + "       AND p.voided=0\n"
          + "       AND pg.program_id=2\n"
          + "       AND ps.state=7\n"
          + "       AND ps.end_date IS NULL\n"
          + "       AND pg.location_id=:location\n"
          + "       AND ps.start_date BETWEEN\n"
          + "         (SELECT inicio.data\n"
          + "          FROM dual\n"
          + "          WHERE p.patient_id=inicio.patient_id) AND date_add(\n"
          + "                                                               (SELECT inicio.data\n"
          + "                                                                FROM dual\n"
          + "                                                                WHERE p.patient_id=inicio.patient_id), interval :months MONTH) )\n"
          + "  AND inicio.patient_id IN\n"
          + "    (SELECT pg.patient_id\n"
          + "     FROM patient p\n"
          + "     INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "     INNER JOIN patient_state ps ON pg.patient_program_id=ps.patient_program_id\n"
          + "     WHERE pg.voided=0\n"
          + "       AND ps.voided=0\n"
          + "       AND p.voided=0\n"
          + "       AND pg.program_id=2\n"
          + "       AND ps.state = 8\n"
          + "       AND ps.end_date IS NULL\n"
          + "       AND ps.start_date BETWEEN\n"
          + "         (SELECT inicio.data\n"
          + "          FROM dual\n"
          + "          WHERE pg.patient_id=inicio.patient_id) AND date_add(\n"
          + "                                                                (SELECT inicio.data\n"
          + "                                                                 FROM dual\n"
          + "                                                                 WHERE pg.patient_id=inicio.patient_id), interval :months MONTH)\n"
          + "       AND location_id=:location )";

  private static final String initiotArv =
      "SELECT inicio.patient_id\n"
          + "FROM\n"
          + "  (SELECT patient_id,\n"
          + "          DATA\n"
          + "   FROM\n"
          + "     (SELECT patient_id,\n"
          + "             min(DATA) DATA\n"
          + "      FROM\n"
          + "        (SELECT p.patient_id,\n"
          + "                min(e.encounter_datetime) DATA\n"
          + "         FROM patient p\n"
          + "         INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "         INNER JOIN obs o ON o.encounter_id=e.encounter_id\n"
          + "         WHERE e.voided=0\n"
          + "           AND o.voided=0\n"
          + "           AND p.voided=0\n"
          + "           AND e.encounter_type IN (18,\n"
          + "                                    6,\n"
          + "                                    9)\n"
          + "           AND o.concept_id=1255\n"
          + "           AND o.value_coded=1256\n"
          + "           AND e.encounter_datetime<=CASE\n"
          + "                                         WHEN :months=12 THEN :endDate\n"
          + "                                         WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                         ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                     END\n"
          + "           AND e.location_id=:location\n"
          + "         GROUP BY p.patient_id\n"
          + "         UNION SELECT p.patient_id,\n"
          + "                      min(value_datetime) DATA\n"
          + "         FROM patient p\n"
          + "         INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "         INNER JOIN obs o ON e.encounter_id=o.encounter_id\n"
          + "         WHERE p.voided=0\n"
          + "           AND e.voided=0\n"
          + "           AND o.voided=0\n"
          + "           AND e.encounter_type IN (18,\n"
          + "                                    6,\n"
          + "                                    9)\n"
          + "           AND o.concept_id=1190\n"
          + "           AND o.value_datetime IS NOT NULL\n"
          + "           AND o.value_datetime<=CASE\n"
          + "                                     WHEN :months=12 THEN :endDate\n"
          + "                                     WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                     ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                 END\n"
          + "           AND e.location_id=:location\n"
          + "         GROUP BY p.patient_id\n"
          + "         UNION SELECT pg.patient_id,\n"
          + "                      date_enrolled DATA\n"
          + "         FROM patient p\n"
          + "         INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "         WHERE pg.voided=0\n"
          + "           AND p.voided=0\n"
          + "           AND program_id=2\n"
          + "           AND date_enrolled<=CASE\n"
          + "                                  WHEN :months=12 THEN :endDate\n"
          + "                                  WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                  ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                              END\n"
          + "           AND location_id=:location\n"
          + "         UNION SELECT e.patient_id,\n"
          + "                      MIN(e.encounter_datetime) AS DATA\n"
          + "         FROM patient p\n"
          + "         INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "         WHERE p.voided=0\n"
          + "           AND e.encounter_type=18\n"
          + "           AND e.voided=0\n"
          + "           AND e.encounter_datetime<=CASE\n"
          + "                                         WHEN :months=12 THEN :endDate\n"
          + "                                         WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                         ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                     END\n"
          + "           AND e.location_id=:location\n"
          + "         GROUP BY p.patient_id) inicio\n"
          + "      GROUP BY patient_id)inicio1\n"
          + "   WHERE DATA BETWEEN CASE\n"
          + "                          WHEN :months=12 THEN :startDate\n"
          + "                          WHEN :months=24 THEN date_add(:endDate, interval -15 MONTH)\n"
          + "                          ELSE date_add(:endDate, interval -27 MONTH)\n"
          + "                      END AND CASE\n"
          + "                                  WHEN :months=12 THEN :endDate\n"
          + "                                  WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                  ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                              END ) inicio\n"
          + "WHERE inicio.patient_id NOT IN\n"
          + "    (SELECT pg.patient_id\n"
          + "     FROM patient p\n"
          + "     INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "     INNER JOIN patient_state ps ON pg.patient_program_id=ps.patient_program_id\n"
          + "     WHERE pg.voided=0\n"
          + "       AND ps.voided=0\n"
          + "       AND p.voided=0\n"
          + "       AND pg.program_id=2\n"
          + "       AND ps.state=7\n"
          + "       AND ps.end_date IS NULL\n"
          + "       AND pg.location_id=:location\n"
          + "       AND ps.start_date BETWEEN\n"
          + "         (SELECT inicio.data\n"
          + "          FROM dual\n"
          + "          WHERE p.patient_id=inicio.patient_id) AND date_add(\n"
          + "                                                               (SELECT inicio.data\n"
          + "                                                                FROM dual\n"
          + "                                                                WHERE p.patient_id=inicio.patient_id), interval :months MONTH) )";

  private static final String notificado =
      "SELECT dominio.paciente\n"
          + "FROM\n"
          + "  (SELECT inicio.patient_id paciente,\n"
          + "          DATA,\n"
          + "          date_add(DATA, interval :months MONTH) data_12_meses,\n"
          + "          ps.state,\n"
          + "          max(obs_fila.value_datetime) proximo_fila,\n"
          + "          max(obs_seguimento.value_datetime) proximo_seguimento\n"
          + "   FROM\n"
          + "     (SELECT patient_id,\n"
          + "             DATA\n"
          + "      FROM\n"
          + "        (SELECT patient_id,\n"
          + "                min(DATA) DATA\n"
          + "         FROM\n"
          + "           (SELECT p.patient_id,\n"
          + "                   min(e.encounter_datetime) DATA\n"
          + "            FROM patient p\n"
          + "            INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "            INNER JOIN obs o ON o.encounter_id=e.encounter_id\n"
          + "            WHERE e.voided=0\n"
          + "              AND o.voided=0\n"
          + "              AND p.voided=0\n"
          + "              AND e.encounter_type IN (18,\n"
          + "                                       6,\n"
          + "                                       9)\n"
          + "              AND o.concept_id=1255\n"
          + "              AND o.value_coded=1256\n"
          + "              AND e.encounter_datetime<=CASE\n"
          + "                                            WHEN :months=12 THEN :endDate\n"
          + "                                            WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                            ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                        END\n"
          + "              AND e.location_id=:location\n"
          + "            GROUP BY p.patient_id\n"
          + "            UNION SELECT p.patient_id,\n"
          + "                         min(value_datetime) DATA\n"
          + "            FROM patient p\n"
          + "            INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "            INNER JOIN obs o ON e.encounter_id=o.encounter_id\n"
          + "            WHERE p.voided=0\n"
          + "              AND e.voided=0\n"
          + "              AND o.voided=0\n"
          + "              AND e.encounter_type IN (18,\n"
          + "                                       6,\n"
          + "                                       9)\n"
          + "              AND o.concept_id=1190\n"
          + "              AND o.value_datetime IS NOT NULL\n"
          + "              AND o.value_datetime<=CASE\n"
          + "                                        WHEN :months=12 THEN :endDate\n"
          + "                                        WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                        ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                    END\n"
          + "              AND e.location_id=:location\n"
          + "            GROUP BY p.patient_id\n"
          + "            UNION SELECT pg.patient_id,\n"
          + "                         date_enrolled DATA\n"
          + "            FROM patient p\n"
          + "            INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "            WHERE pg.voided=0\n"
          + "              AND p.voided=0\n"
          + "              AND program_id=2\n"
          + "              AND date_enrolled<=CASE\n"
          + "                                     WHEN :months=12 THEN :endDate\n"
          + "                                     WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                     ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                 END\n"
          + "              AND location_id=:location\n"
          + "            UNION SELECT e.patient_id,\n"
          + "                         MIN(e.encounter_datetime) AS DATA\n"
          + "            FROM patient p\n"
          + "            INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "            WHERE p.voided=0\n"
          + "              AND e.encounter_type=18\n"
          + "              AND e.voided=0\n"
          + "              AND e.encounter_datetime<=CASE\n"
          + "                                            WHEN :months=12 THEN :endDate\n"
          + "                                            WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                            ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                        END\n"
          + "              AND e.location_id=:location\n"
          + "            GROUP BY p.patient_id) inicio\n"
          + "         GROUP BY patient_id)inicio1\n"
          + "      WHERE DATA BETWEEN CASE\n"
          + "                             WHEN :months=12 THEN :startDate\n"
          + "                             WHEN :months=24 THEN date_add(:endDate, interval -15 MONTH)\n"
          + "                             ELSE date_add(:endDate, interval -27 MONTH)\n"
          + "                         END AND CASE\n"
          + "                                     WHEN :months=12 THEN :endDate\n"
          + "                                     WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                     ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                 END ) inicio\n"
          + "   LEFT JOIN obs obs_fila ON (obs_fila.person_id = inicio.patient_id\n"
          + "                              AND obs_fila.concept_id =5096\n"
          + "                              AND obs_fila.voided= 0\n"
          + "                              AND obs_fila.encounter_id IN\n"
          + "                                (SELECT max(e.encounter_id)\n"
          + "                                 FROM encounter e\n"
          + "                                 WHERE e.encounter_type =18\n"
          + "                                   AND e.encounter_id = obs_fila.encounter_id\n"
          + "                                   AND e.voided = 0\n"
          + "                                   AND e.patient_id = inicio.patient_id\n"
          + "                                   AND e.encounter_datetime BETWEEN inicio.data AND date_add(inicio.data, interval :months MONTH)\n"
          + "                                 GROUP BY e.encounter_id))\n"
          + "   LEFT JOIN obs obs_seguimento ON (obs_seguimento.concept_id =1410\n"
          + "                                    AND obs_seguimento.voided = 0\n"
          + "                                    AND obs_seguimento.person_id = inicio.patient_id\n"
          + "                                    AND obs_seguimento.encounter_id IN\n"
          + "                                      (SELECT max(e.encounter_id)\n"
          + "                                       FROM encounter e\n"
          + "                                       WHERE e.encounter_type IN (6,\n"
          + "                                                                  9)\n"
          + "                                         AND e.encounter_id = obs_seguimento.encounter_id\n"
          + "                                         AND e.voided = 0\n"
          + "                                         AND e.patient_id = inicio.patient_id\n"
          + "                                         AND e.encounter_datetime BETWEEN inicio.data AND date_add(inicio.data, interval :months MONTH)\n"
          + "                                       GROUP BY e.encounter_id))\n"
          + "   LEFT JOIN patient_program pp ON pp.patient_id = inicio.patient_id\n"
          + "   AND pp.program_id =2\n"
          + "   AND pp.voided = FALSE\n"
          + "   LEFT JOIN patient_state ps ON (ps.patient_program_id = pp.patient_program_id\n"
          + "                                  AND ps.voided = FALSE\n"
          + "                                  AND ps.patient_state_id =\n"
          + "                                    (SELECT max(ps1.patient_state_id)\n"
          + "                                     FROM patient_state ps1\n"
          + "                                     WHERE ps1.patient_program_id = pp.patient_program_id\n"
          + "                                       AND ps1.start_date <= date_add(inicio.data, interval :months MONTH) ))\n"
          + "   WHERE inicio.patient_id NOT IN\n"
          + "       (SELECT pg.patient_id\n"
          + "        FROM patient p\n"
          + "        INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "        INNER JOIN patient_state ps ON pg.patient_program_id=ps.patient_program_id\n"
          + "        WHERE pg.voided=0\n"
          + "          AND ps.voided=0\n"
          + "          AND p.voided=0\n"
          + "          AND pg.program_id=2\n"
          + "          AND ps.state=7\n"
          + "          AND ps.end_date IS NULL\n"
          + "          AND pg.location_id=:location\n"
          + "          AND ps.start_date BETWEEN\n"
          + "            (SELECT inicio.data\n"
          + "             FROM dual\n"
          + "             WHERE p.patient_id=inicio.patient_id) AND date_add(\n"
          + "                                                                  (SELECT inicio.data\n"
          + "                                                                   FROM dual\n"
          + "                                                                   WHERE p.patient_id=inicio.patient_id), interval :months MONTH) )\n"
          + "   GROUP BY inicio.patient_id) dominio\n"
          + "WHERE 1=1\n"
          + "  AND dominio.state = 9\n"
          + "  AND NOT (datediff(dominio.data_12_meses, COALESCE(dominio.proximo_fila, dominio.data)) < 60\n"
          + "           OR datediff(dominio.data_12_meses, COALESCE(dominio.proximo_seguimento, dominio.data)) < 60)";

  private static final String naonotificado =
      "SELECT dominio.paciente\n"
          + "FROM\n"
          + "  (SELECT inicio.patient_id paciente,\n"
          + "          DATA,\n"
          + "          date_add(DATA, interval :months MONTH) data_12_meses,\n"
          + "          ps.state,\n"
          + "          max(obs_fila.value_datetime) proximo_fila,\n"
          + "          max(obs_seguimento.value_datetime) proximo_seguimento\n"
          + "   FROM\n"
          + "     (SELECT patient_id,\n"
          + "             DATA\n"
          + "      FROM\n"
          + "        (SELECT patient_id,\n"
          + "                min(DATA) DATA\n"
          + "         FROM\n"
          + "           (SELECT p.patient_id,\n"
          + "                   min(e.encounter_datetime) DATA\n"
          + "            FROM patient p\n"
          + "            INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "            INNER JOIN obs o ON o.encounter_id=e.encounter_id\n"
          + "            WHERE e.voided=0\n"
          + "              AND o.voided=0\n"
          + "              AND p.voided=0\n"
          + "              AND e.encounter_type IN (18,\n"
          + "                                       6,\n"
          + "                                       9)\n"
          + "              AND o.concept_id=1255\n"
          + "              AND o.value_coded=1256\n"
          + "              AND e.encounter_datetime<=CASE\n"
          + "                                            WHEN :months=12 THEN :endDate\n"
          + "                                            WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                            ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                        END\n"
          + "              AND e.location_id=:location\n"
          + "            GROUP BY p.patient_id\n"
          + "            UNION SELECT p.patient_id,\n"
          + "                         min(value_datetime) DATA\n"
          + "            FROM patient p\n"
          + "            INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "            INNER JOIN obs o ON e.encounter_id=o.encounter_id\n"
          + "            WHERE p.voided=0\n"
          + "              AND e.voided=0\n"
          + "              AND o.voided=0\n"
          + "              AND e.encounter_type IN (18,\n"
          + "                                       6,\n"
          + "                                       9)\n"
          + "              AND o.concept_id=1190\n"
          + "              AND o.value_datetime IS NOT NULL\n"
          + "              AND o.value_datetime<=CASE\n"
          + "                                        WHEN :months=12 THEN :endDate\n"
          + "                                        WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                        ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                    END\n"
          + "              AND e.location_id=:location\n"
          + "            GROUP BY p.patient_id\n"
          + "            UNION SELECT pg.patient_id,\n"
          + "                         date_enrolled DATA\n"
          + "            FROM patient p\n"
          + "            INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "            WHERE pg.voided=0\n"
          + "              AND p.voided=0\n"
          + "              AND program_id=2\n"
          + "              AND date_enrolled<=CASE\n"
          + "                                     WHEN :months=12 THEN :endDate\n"
          + "                                     WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                     ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                 END\n"
          + "              AND location_id=:location\n"
          + "            UNION SELECT e.patient_id,\n"
          + "                         MIN(e.encounter_datetime) AS DATA\n"
          + "            FROM patient p\n"
          + "            INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "            WHERE p.voided=0\n"
          + "              AND e.encounter_type=18\n"
          + "              AND e.voided=0\n"
          + "              AND e.encounter_datetime<=CASE\n"
          + "                                            WHEN :months=12 THEN :endDate\n"
          + "                                            WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                            ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                        END\n"
          + "              AND e.location_id=:location\n"
          + "            GROUP BY p.patient_id) inicio\n"
          + "         GROUP BY patient_id)inicio1\n"
          + "      WHERE DATA BETWEEN CASE\n"
          + "                             WHEN :months=12 THEN :startDate\n"
          + "                             WHEN :months=24 THEN date_add(:endDate, interval -15 MONTH)\n"
          + "                             ELSE date_add(:endDate, interval -27 MONTH)\n"
          + "                         END AND CASE\n"
          + "                                     WHEN :months=12 THEN :endDate\n"
          + "                                     WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                     ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                 END ) inicio\n"
          + "   LEFT JOIN obs obs_fila ON (obs_fila.person_id = inicio.patient_id\n"
          + "                              AND obs_fila.concept_id =5096\n"
          + "                              AND obs_fila.voided= 0\n"
          + "                              AND obs_fila.encounter_id IN\n"
          + "                                (SELECT max(e.encounter_id)\n"
          + "                                 FROM encounter e\n"
          + "                                 WHERE e.encounter_type =18\n"
          + "                                   AND e.encounter_id = obs_fila.encounter_id\n"
          + "                                   AND e.voided = 0\n"
          + "                                   AND e.patient_id = inicio.patient_id\n"
          + "                                   AND e.encounter_datetime BETWEEN inicio.data AND date_add(inicio.data, interval :months MONTH)\n"
          + "                                 GROUP BY e.encounter_id))\n"
          + "   LEFT JOIN obs obs_seguimento ON (obs_seguimento.concept_id =1410\n"
          + "                                    AND obs_seguimento.voided = 0\n"
          + "                                    AND obs_seguimento.person_id = inicio.patient_id\n"
          + "                                    AND obs_seguimento.encounter_id IN\n"
          + "                                      (SELECT max(e.encounter_id)\n"
          + "                                       FROM encounter e\n"
          + "                                       WHERE e.encounter_type IN (6,\n"
          + "                                                                  9)\n"
          + "                                         AND e.encounter_id = obs_seguimento.encounter_id\n"
          + "                                         AND e.voided = 0\n"
          + "                                         AND e.patient_id = inicio.patient_id\n"
          + "                                         AND e.encounter_datetime BETWEEN inicio.data AND date_add(inicio.data, interval :months MONTH)\n"
          + "                                       GROUP BY e.encounter_id))\n"
          + "   LEFT JOIN patient_program pp ON pp.patient_id = inicio.patient_id\n"
          + "   AND pp.program_id =2\n"
          + "   AND pp.voided = FALSE\n"
          + "   LEFT JOIN patient_state ps ON (ps.patient_program_id = pp.patient_program_id\n"
          + "                                  AND ps.voided = FALSE\n"
          + "                                  AND ps.patient_state_id =\n"
          + "                                    (SELECT max(ps1.patient_state_id)\n"
          + "                                     FROM patient_state ps1\n"
          + "                                     WHERE ps1.patient_program_id = pp.patient_program_id\n"
          + "                                       AND ps1.start_date <= date_add(inicio.data, interval :months MONTH) ))\n"
          + "   WHERE inicio.patient_id NOT IN\n"
          + "       (SELECT pg.patient_id\n"
          + "        FROM patient p\n"
          + "        INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "        INNER JOIN patient_state ps ON pg.patient_program_id=ps.patient_program_id\n"
          + "        WHERE pg.voided=0\n"
          + "          AND ps.voided=0\n"
          + "          AND p.voided=0\n"
          + "          AND pg.program_id=2\n"
          + "          AND ps.state=7\n"
          + "          AND ps.end_date IS NULL\n"
          + "          AND pg.location_id=:location\n"
          + "          AND ps.start_date BETWEEN\n"
          + "            (SELECT inicio.data\n"
          + "             FROM dual\n"
          + "             WHERE p.patient_id=inicio.patient_id) AND date_add(\n"
          + "                                                                  (SELECT inicio.data\n"
          + "                                                                   FROM dual\n"
          + "                                                                   WHERE p.patient_id=inicio.patient_id), interval :months MONTH) )\n"
          + "   GROUP BY inicio.patient_id) dominio\n"
          + "WHERE 1=1\n"
          + "  AND datediff(dominio.data_12_meses, COALESCE(dominio.proximo_fila, dominio.data)) >= 60\n"
          + "  AND not((COALESCE(dominio.state, 6) IN (8, 9, 10))\n"
          + "          OR (datediff(dominio.data_12_meses, COALESCE(dominio.proximo_seguimento, dominio.data)) < 60))";

  private static final String courtNotTransferred =
      "SELECT inicio.patient_id\n"
          + "FROM\n"
          + "  (SELECT patient_id,\n"
          + "          DATA\n"
          + "   FROM\n"
          + "     (SELECT patient_id,\n"
          + "             min(DATA) DATA\n"
          + "      FROM\n"
          + "        (SELECT p.patient_id,\n"
          + "                min(e.encounter_datetime) DATA\n"
          + "         FROM patient p\n"
          + "         INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "         INNER JOIN obs o ON o.encounter_id=e.encounter_id\n"
          + "         WHERE e.voided=0\n"
          + "           AND o.voided=0\n"
          + "           AND p.voided=0\n"
          + "           AND e.encounter_type IN (18,\n"
          + "                                    6,\n"
          + "                                    9)\n"
          + "           AND o.concept_id=1255\n"
          + "           AND o.value_coded=1256\n"
          + "           AND e.encounter_datetime<=CASE\n"
          + "                                         WHEN :months=12 THEN :endDate\n"
          + "                                         WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                         ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                     END\n"
          + "           AND e.location_id=:location\n"
          + "         GROUP BY p.patient_id\n"
          + "         UNION SELECT p.patient_id,\n"
          + "                      min(value_datetime) DATA\n"
          + "         FROM patient p\n"
          + "         INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "         INNER JOIN obs o ON e.encounter_id=o.encounter_id\n"
          + "         WHERE p.voided=0\n"
          + "           AND e.voided=0\n"
          + "           AND o.voided=0\n"
          + "           AND e.encounter_type IN (18,\n"
          + "                                    6,\n"
          + "                                    9)\n"
          + "           AND o.concept_id=1190\n"
          + "           AND o.value_datetime IS NOT NULL\n"
          + "           AND o.value_datetime<=CASE\n"
          + "                                     WHEN :months=12 THEN :endDate\n"
          + "                                     WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                     ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                 END\n"
          + "           AND e.location_id=:location\n"
          + "         GROUP BY p.patient_id\n"
          + "         UNION SELECT pg.patient_id,\n"
          + "                      date_enrolled DATA\n"
          + "         FROM patient p\n"
          + "         INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "         WHERE pg.voided=0\n"
          + "           AND p.voided=0\n"
          + "           AND program_id=2\n"
          + "           AND date_enrolled<=CASE\n"
          + "                                  WHEN :months=12 THEN :endDate\n"
          + "                                  WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                  ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                              END\n"
          + "           AND location_id=:location\n"
          + "         UNION SELECT e.patient_id,\n"
          + "                      MIN(e.encounter_datetime) AS DATA\n"
          + "         FROM patient p\n"
          + "         INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "         WHERE p.voided=0\n"
          + "           AND e.encounter_type=18\n"
          + "           AND e.voided=0\n"
          + "           AND e.encounter_datetime<=CASE\n"
          + "                                         WHEN :months=12 THEN :endDate\n"
          + "                                         WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                         ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                                     END\n"
          + "           AND e.location_id=:location\n"
          + "         GROUP BY p.patient_id) inicio\n"
          + "      GROUP BY patient_id)inicio1\n"
          + "   WHERE DATA BETWEEN CASE\n"
          + "                          WHEN :months=12 THEN :startDate\n"
          + "                          WHEN :months=24 THEN date_add(:endDate, interval -15 MONTH)\n"
          + "                          ELSE date_add(:endDate, interval -27 MONTH)\n"
          + "                      END AND CASE\n"
          + "                                  WHEN :months=12 THEN :endDate\n"
          + "                                  WHEN :months=24 THEN date_add(:endDate, interval -12 MONTH)\n"
          + "                                  ELSE date_add(:endDate, interval -24 MONTH)\n"
          + "                              END ) inicio\n"
          + "WHERE inicio.patient_id NOT IN\n"
          + "    (SELECT pg.patient_id\n"
          + "     FROM patient p\n"
          + "     INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "     INNER JOIN patient_state ps ON pg.patient_program_id=ps.patient_program_id\n"
          + "     WHERE pg.voided=0\n"
          + "       AND ps.voided=0\n"
          + "       AND p.voided=0\n"
          + "       AND pg.program_id=2\n"
          + "       AND ps.state=7\n"
          + "       AND ps.end_date IS NULL\n"
          + "       AND pg.location_id=:location\n"
          + "       AND ps.start_date BETWEEN\n"
          + "         (SELECT inicio.data\n"
          + "          FROM dual\n"
          + "          WHERE p.patient_id=inicio.patient_id) AND date_add(\n"
          + "                                                               (SELECT inicio.data\n"
          + "                                                                FROM dual\n"
          + "                                                                WHERE p.patient_id=inicio.patient_id), interval :months MONTH) )";

  private static final String under1YearIncreasedHARTAtARTStartDate =
      "SELECT patient_id\n"
          + "FROM\n"
          + "  (SELECT patient_id,\n"
          + "          min(data_inicio) data_inicio\n"
          + "   FROM\n"
          + "     (SELECT p.patient_id,\n"
          + "             min(e.encounter_datetime) data_inicio\n"
          + "      FROM patient p\n"
          + "      INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "      INNER JOIN obs o ON o.encounter_id=e.encounter_id\n"
          + "      WHERE e.voided=0\n"
          + "        AND o.voided=0\n"
          + "        AND p.voided=0\n"
          + "        AND e.encounter_type IN (18,\n"
          + "                                 6,\n"
          + "                                 9)\n"
          + "        AND o.concept_id=1255\n"
          + "        AND o.value_coded=1256\n"
          + "        AND e.encounter_datetime<=:endDate\n"
          + "        AND e.location_id=:location\n"
          + "      GROUP BY p.patient_id\n"
          + "      UNION SELECT p.patient_id,\n"
          + "                   min(value_datetime) data_inicio\n"
          + "      FROM patient p\n"
          + "      INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "      INNER JOIN obs o ON e.encounter_id=o.encounter_id\n"
          + "      WHERE p.voided=0\n"
          + "        AND e.voided=0\n"
          + "        AND o.voided=0\n"
          + "        AND e.encounter_type IN (18,\n"
          + "                                 6,\n"
          + "                                 9)\n"
          + "        AND o.concept_id=1190\n"
          + "        AND o.value_datetime IS NOT NULL\n"
          + "        AND o.value_datetime<=:endDate\n"
          + "        AND e.location_id=:location\n"
          + "      GROUP BY p.patient_id\n"
          + "      UNION SELECT pg.patient_id,\n"
          + "                   date_enrolled AS data_inicio\n"
          + "      FROM patient p\n"
          + "      INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "      WHERE pg.voided=0\n"
          + "        AND p.voided=0\n"
          + "        AND program_id=2\n"
          + "        AND pg.date_enrolled<=:endDate\n"
          + "        AND pg.location_id=:location\n"
          + "      UNION SELECT p.patient_id,\n"
          + "                   min(encounter_datetime)\n"
          + "      FROM patient p\n"
          + "      INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "      WHERE p.voided=0\n"
          + "        AND e.voided=0\n"
          + "        AND e.encounter_type=18\n"
          + "        AND e.encounter_datetime<=:endDate\n"
          + "        AND e.location_id=:location\n"
          + "      GROUP BY p.patient_id) inicio\n"
          + "   GROUP BY patient_id)inicio_real\n"
          + "INNER JOIN person pe ON inicio_real.patient_id=pe.person_id\n"
          + "WHERE timestampdiff(YEAR, birthdate, data_inicio)<1";

  private static final String oneTo19WhoStartedTargetAtARTInitiation =
      "SELECT patient_id\n"
          + "FROM\n"
          + "  (SELECT patient_id,\n"
          + "          min(data_inicio) data_inicio\n"
          + "   FROM\n"
          + "     (SELECT p.patient_id,\n"
          + "             min(e.encounter_datetime) data_inicio\n"
          + "      FROM patient p\n"
          + "      INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "      INNER JOIN obs o ON o.encounter_id=e.encounter_id\n"
          + "      WHERE e.voided=0\n"
          + "        AND o.voided=0\n"
          + "        AND p.voided=0\n"
          + "        AND e.encounter_type IN (18,\n"
          + "                                 6,\n"
          + "                                 9)\n"
          + "        AND o.concept_id=1255\n"
          + "        AND o.value_coded=1256\n"
          + "        AND e.encounter_datetime<=:endDate\n"
          + "        AND e.location_id=:location\n"
          + "      GROUP BY p.patient_id\n"
          + "      UNION SELECT p.patient_id,\n"
          + "                   min(value_datetime) data_inicio\n"
          + "      FROM patient p\n"
          + "      INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "      INNER JOIN obs o ON e.encounter_id=o.encounter_id\n"
          + "      WHERE p.voided=0\n"
          + "        AND e.voided=0\n"
          + "        AND o.voided=0\n"
          + "        AND e.encounter_type IN (18,\n"
          + "                                 6,\n"
          + "                                 9)\n"
          + "        AND o.concept_id=1190\n"
          + "        AND o.value_datetime IS NOT NULL\n"
          + "        AND o.value_datetime<=:endDate\n"
          + "        AND e.location_id=:location\n"
          + "      GROUP BY p.patient_id\n"
          + "      UNION SELECT pg.patient_id,\n"
          + "                   date_enrolled AS data_inicio\n"
          + "      FROM patient p\n"
          + "      INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "      WHERE pg.voided=0\n"
          + "        AND p.voided=0\n"
          + "        AND program_id=2\n"
          + "        AND pg.date_enrolled<=:endDate\n"
          + "        AND pg.location_id=:location\n"
          + "      UNION SELECT p.patient_id,\n"
          + "                   min(encounter_datetime)\n"
          + "      FROM patient p\n"
          + "      INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "      WHERE p.voided=0\n"
          + "        AND e.voided=0\n"
          + "        AND e.encounter_type=18\n"
          + "        AND e.encounter_datetime<=:endDate\n"
          + "        AND e.location_id=:location\n"
          + "      GROUP BY p.patient_id) inicio\n"
          + "   GROUP BY patient_id)inicio_real\n"
          + "INNER JOIN person pe ON inicio_real.patient_id=pe.person_id\n"
          + "WHERE timestampdiff(YEAR, birthdate, data_inicio)>=1\n"
          + "  AND timestampdiff(YEAR, birthdate, data_inicio)<10";

  private static final String genderOnArtXToY =
      "SELECT patient_id\n"
          + "FROM\n"
          + "  (SELECT patient_id,\n"
          + "          min(data_inicio) data_inicio\n"
          + "   FROM\n"
          + "     (SELECT p.patient_id,\n"
          + "             min(e.encounter_datetime) data_inicio\n"
          + "      FROM patient p\n"
          + "      INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "      INNER JOIN obs o ON o.encounter_id=e.encounter_id\n"
          + "      WHERE e.voided=0\n"
          + "        AND o.voided=0\n"
          + "        AND p.voided=0\n"
          + "        AND e.encounter_type IN (18,\n"
          + "                                 6,\n"
          + "                                 9)\n"
          + "        AND o.concept_id=1255\n"
          + "        AND o.value_coded=1256\n"
          + "        AND e.encounter_datetime<=:endDate\n"
          + "        AND e.location_id=:location\n"
          + "      GROUP BY p.patient_id\n"
          + "      UNION SELECT p.patient_id,\n"
          + "                   min(value_datetime) data_inicio\n"
          + "      FROM patient p\n"
          + "      INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "      INNER JOIN obs o ON e.encounter_id=o.encounter_id\n"
          + "      WHERE p.voided=0\n"
          + "        AND e.voided=0\n"
          + "        AND o.voided=0\n"
          + "        AND e.encounter_type IN (18,\n"
          + "                                 6,\n"
          + "                                 9)\n"
          + "        AND o.concept_id=1190\n"
          + "        AND o.value_datetime IS NOT NULL\n"
          + "        AND o.value_datetime<=:endDate\n"
          + "        AND e.location_id=:location\n"
          + "      GROUP BY p.patient_id\n"
          + "      UNION SELECT pg.patient_id,\n"
          + "                   date_enrolled AS data_inicio\n"
          + "      FROM patient p\n"
          + "      INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "      WHERE pg.voided=0\n"
          + "        AND p.voided=0\n"
          + "        AND program_id=2\n"
          + "        AND pg.date_enrolled<=:endDate\n"
          + "        AND pg.location_id=:location\n"
          + "      UNION SELECT p.patient_id,\n"
          + "                   min(encounter_datetime)\n"
          + "      FROM patient p\n"
          + "      INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "      WHERE p.voided=0\n"
          + "        AND e.voided=0\n"
          + "        AND e.encounter_type=18\n"
          + "        AND e.encounter_datetime<=:endDate\n"
          + "        AND e.location_id=:location\n"
          + "      GROUP BY p.patient_id) inicio\n"
          + "   GROUP BY patient_id)inicio_real\n"
          + "INNER JOIN person pe ON inicio_real.patient_id=pe.person_id\n"
          + "WHERE timestampdiff(YEAR, birthdate, data_inicio)>=%d\n"
          + "  AND timestampdiff(YEAR, birthdate, data_inicio)<%d\n"
          + "  AND gender='%s'";

  private static final String genderOnArtAbove50 =
      "SELECT patient_id\n"
          + "FROM\n"
          + "  (SELECT patient_id,\n"
          + "          min(data_inicio) data_inicio\n"
          + "   FROM\n"
          + "     (SELECT p.patient_id,\n"
          + "             min(e.encounter_datetime) data_inicio\n"
          + "      FROM patient p\n"
          + "      INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "      INNER JOIN obs o ON o.encounter_id=e.encounter_id\n"
          + "      WHERE e.voided=0\n"
          + "        AND o.voided=0\n"
          + "        AND p.voided=0\n"
          + "        AND e.encounter_type IN (18,\n"
          + "                                 6,\n"
          + "                                 9)\n"
          + "        AND o.concept_id=1255\n"
          + "        AND o.value_coded=1256\n"
          + "        AND e.encounter_datetime<=:endDate\n"
          + "        AND e.location_id=:location\n"
          + "      GROUP BY p.patient_id\n"
          + "      UNION SELECT p.patient_id,\n"
          + "                   min(value_datetime) data_inicio\n"
          + "      FROM patient p\n"
          + "      INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "      INNER JOIN obs o ON e.encounter_id=o.encounter_id\n"
          + "      WHERE p.voided=0\n"
          + "        AND e.voided=0\n"
          + "        AND o.voided=0\n"
          + "        AND e.encounter_type IN (18,\n"
          + "                                 6,\n"
          + "                                 9)\n"
          + "        AND o.concept_id=1190\n"
          + "        AND o.value_datetime IS NOT NULL\n"
          + "        AND o.value_datetime<=:endDate\n"
          + "        AND e.location_id=:location\n"
          + "      GROUP BY p.patient_id\n"
          + "      UNION SELECT pg.patient_id,\n"
          + "                   date_enrolled AS data_inicio\n"
          + "      FROM patient p\n"
          + "      INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "      WHERE pg.voided=0\n"
          + "        AND p.voided=0\n"
          + "        AND program_id=2\n"
          + "        AND pg.date_enrolled<=:endDate\n"
          + "        AND pg.location_id=:location\n"
          + "      UNION SELECT p.patient_id,\n"
          + "                   min(encounter_datetime)\n"
          + "      FROM patient p\n"
          + "      INNER JOIN encounter e ON p.patient_id=e.patient_id\n"
          + "      WHERE p.voided=0\n"
          + "        AND e.voided=0\n"
          + "        AND e.encounter_type=18\n"
          + "        AND e.encounter_datetime<=:endDate\n"
          + "        AND e.location_id=:location\n"
          + "      GROUP BY p.patient_id) inicio\n"
          + "   GROUP BY patient_id)inicio_real\n"
          + "INNER JOIN person pe ON inicio_real.patient_id=pe.person_id\n"
          + "WHERE timestampdiff(YEAR, birthdate, data_inicio)>=50\n"
          + "  AND gender='%s'";

  private static final String infantsWhoGaveAwardsTwoYearsBehindReferenceDate =
      "SELECT pg.patient_id\n"
          + "FROM patient p\n"
          + "INNER JOIN patient_program pg ON p.patient_id=pg.patient_id\n"
          + "INNER JOIN patient_state ps ON pg.patient_program_id=ps.patient_program_id\n"
          + "WHERE pg.voided=0\n"
          + "  AND ps.voided=0\n"
          + "  AND p.voided=0\n"
          + "  AND pg.program_id=8\n"
          + "  AND ps.state=27\n"
          + "  AND ps.end_date IS NULL\n"
          + "  AND ps.start_date BETWEEN date_add(:startDate, interval -2 YEAR) AND date_add(:startDate, interval -1 DAY)\n"
          + "  AND location_id=:location";

  public static String obitoTwelveMonths() {
    return obito;
  }

  public static String suspensoTwelveMonths() {
    return suspenso;
  }

  public static String initiotArvTwelveMonths() {
    return initiotArv;
  }

  /** abandono = NOTIFICADO OR NAONOTIFICADO */
  public static String naonotificadoTwelveMonths() {
    return naonotificado;
  }

  /** abandono = NOTIFICADO OR NAONOTIFICADO */
  public static String notificadoTwelveMonths() {
    return notificado;
  }

  public static String courtNotTransferredTwelveMonths() {
    return courtNotTransferred;
  }

  public static String under1YearIncreasedHARTAtARTStartDate() {
    return under1YearIncreasedHARTAtARTStartDate;
  }

  public static String oneTo19WhoStartedTargetAtARTInitiation() {
    return oneTo19WhoStartedTargetAtARTInitiation;
  }

  public static String genderOnArtXToY(String gender, Integer minAge, Integer maxAge) {
    return String.format(genderOnArtXToY, minAge, maxAge + 1, gender);
  }

  public static String genderOnArtAbove50(String gender) {
    return String.format(genderOnArtAbove50, gender);
  }

  public static String infantsWhoGaveAwardsTwoYearsBehindReferenceDate() {
    return infantsWhoGaveAwardsTwoYearsBehindReferenceDate;
  }
}
